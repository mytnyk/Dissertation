
\section{Нейронечітка модель у формі Бернштейна}

Технологія створення векторних зображень за допомогою кривих була
винайдена на початку 60-х років П'єром Без'є, інженером фірми
Renault, і Полем де Кастельжо (Кастельє), інженером компанії
Citroen. Оскільки вони обидва працювали над створенням креслень
нових автомобілів, всі їх дослідження до певного часу не
розповсюджувалися. Робота Поля де Кастельжо була завершена першою
але так жодного разу і не була опублікованою. П'єру Без'є
пощастило більше. Його іменем і була названа нова технологія, хоча
математичні вирази, відповідно до яких виконуються перетворення
Без'є, були винайдені в основному паном де Кастельжо~\cite{Donny}.
Математична теорія барицентричних координат і алгоритм Кастельжо,
які широко використовуються при побудові кривих та поверхонь Без'є
в області автоматизованого проектування трьохвимірних систем,
знаходять своє застосування і при побудові нейронечітких моделей
для нелінійних динамічних систем.

\subsection{Алгоритм побудови нейронечіткої моделі у формі Бернштейна}

Розглянемо алгоритм побудови нейронечітких моделей для нелінійних
динамічних систем, запропонований К.Харрісом~ \cite{Hong-Harris,
Harris-Hong}. Основа цього підходу полягає у використанні поліномів
у формі Бернштейна однієї та двох змінних в якості базисних для
представлення виходу нелінійної системи у вигляді наступного
розкладу Габора-Колмогорова:
\begin{equation}
\label{gabor_expan} %
y(\mathbf{x}) =
b+\sum_{k=1}^nB_k(x^k)+\sum_{p=1}^{n-1}\sum_{q=p+1}^nB_{pq}\left(x^p,
x^q\right)+e(\mathbf{x}),
\end{equation}
де вектор входу нелінійної системи $\mathbf{x}=(x^1,\ldots,x^n)^\top
\in \mathcal{X} \subset {\mathbb R^n}$. $\mathcal{X}$ --- простір
входу системи розмірності $n$. Величина $e(\mathbf{x})$ відображає
адитивну шумову складову системи. Для формування поліномів у формі
Бернштейна однієї та двох змінних використовуються лінійні
комбінації відповідних базисних поліномів Бернштейна від
барицентричних координат $u$ та $\mathbf{u}$:
\begin{equation}
\label{univar_expan} %
B_k(x^k)=\sum_{j=0}^dw_j\phi_j^d\Bigl(u(x^k)\Bigr),
\end{equation}
\begin{equation}
\label{bivar_expan} %
B_{pq}(x^p,x^q)=\sum_{i+j+k=d}w_{ijk}\phi_{ijk}^d\Bigl(\mathbf{u}(x^p,
x^q)\Bigr),
\end{equation}
де $u\in \mathcal{U}^1 \subset {\mathbb R^1}$,
$\mathbf{u}=\left(u,v\right)^\top \in \mathcal{U}^2 \subset {\mathbb
R^2}$. $\mathcal{U}^1$, $\mathcal{U}^2$ --- простори барицентричних
координат. Базисні поліноми Бернштейна порядку $d$ однієї і двох
змінних відповідно мають вигляд:
\begin{equation}
\label{BernsteinPoly}
\begin{array}{c}
\phi_j^d(u)=\dbinom{d}{j} \cdot u^j(1-u)^{d-j},\\
\phi_{ijk}^d(\mathbf{u})= \dbinom{d}{i,j,k}\cdot
u^iv^j(1-u-v)^k,\quad i+j+k=d.
\end{array}
\end{equation}
При цьому кожен поліном у формі Бернштейна відповідає виходу
нейронечіткої підсистеми~(\ref{gener_neuro}), а базисні поліноми
Бернштейна виступають в ролі функцій належності для представлення її
входів. Зазначимо, що за побудовою базисні поліноми Бернштейна є
невід'ємними і задовольняють умовам:
$$
\sum_{j=0}^d\phi_j^d(u)=1,\quad\sum_{i+j+k=d}\phi_{ijk}^d(\mathbf{u})=1.
$$
Тож їх можна використовувати в ролі функцій належності.

Таким чином нелінійна система~(\ref{gabor_expan}), структура
якої зображена на рис.~\ref{fig:bbnet}, розглядається як
суперпозиція таких нейронечітких підсистем.
\begin{figure}[t]
\safepdf{\centerline{\includegraphics[height=6cm]{CHAPTER2/EPS/bb_net.pdf}}}
{\centerline{\psfig{figure=CHAPTER2/EPS/bb_net.eps,height=6cm}}}
\caption{Структура нейронечіткої моделі К.Харріса.}
\label{fig:bbnet}
\end{figure}
Барицентричні координати в свою чергу обчислюються за допомогою
обернених відображень Кастельжо:
$$
\Psi_k(\Lambda_k) : x^k\mapsto u(x^k)\in \supp\phi(\cdot)=[0; 1]
\qquad \mbox{та}
$$
$$
\Psi_{pq}(\Lambda_{pq}) : (x^p, x^q)\mapsto \mathbf{u}(x^p,x^q)\in
\supp\phi(\cdot,\cdot)=\triangle\{u\geqslant0, v\geqslant0,
u+v\leqslant1 \}.
$$
Прямий алгоритм Кастельжо детально описаний в
розділі~\ref{casteljau_section} Відображення $\Psi_k$, $\Psi_{pq}$,
будуються на основі наперед заданих множин базових контрольних точок
$\Lambda_k, \Lambda_{pq}$, використовуючи ітераційний чисельний
метод зворотного розповсюдження помилки~\cite{Harris-Hong-2}. Після
обчислення барицентричних координат знаходяться оцінки вагових
коефіцієнтів відповідних рівнянь регресії~(\ref{gabor_expan},
\ref{univar_expan}, \ref{bivar_expan}) двох етапним методом
найменших квадратів (МНК) або ортогональним методом найменших
квадратів (ОМНК)~\cite{Chen-Billings, Wang-Mendel,Chen-Cowan-Grant}.
Тобто відбувається навчання нейронечітких підсистем.

Загальна кількість невідомих коефіцієнтів при базисних поліномах
Бернштейна, які відповідають фактично нечітким правилам, становить
$p=n(d+1)+\frac{1}{4}n(n-1)(d+1)(d+2)$. Тож значною перевагою
підходу К.Харріса є квадратична складність алгоритму навчання
$\mathcal{O}(n^2)$, порівняно з локальними нейронечіткими моделями
Такаґі-Суґено або з традиційними нейронечіткими моделями на основі
B-сплайнів, де складність становить $\mathcal{O}(m^n)$.
\begin{rem}\label{Bernstein-poly-B-spline}
Базисний поліном Бернштейна є частковим випадком B-сплайну.
\end{rem}
\begin{proof}
Дійсно, як показано в~\cite{Hartmut-Wolfgang}, якщо
в~(\ref{b-splines}) покласти
$$
a_1=\ldots=a_m=0,\quad a_{m+1}=\ldots=a_{2m}=1,
$$
тоді $ N_i^d(u)=\phi_i^d(u), \quad i=1,\ldots,m, \quad u\in[0;1)$.
\end{proof}
Будемо називати нейронечіткі моделі Харріса нейронечіткими моделями
у формі Бернштейна. Недоліки підходу К.Харріса:
\begin{enumerate}
%\item Барицентричні координати обчислюються не точно, а із заданим
%рівнем точності. %
\item Ітеративність чисельного методу негативно впливає на
швидкість його роботи, особливо при великій кількості вхідних
змінних і великому розмірі вибірки. %
\item Залишається відкритим питання про вибір порядку поліномів.%
\item Невизначеність розміщення базових контрольних точок.%
\item Необґрунтована можливість незалежного використання нечітких
правил, які сформовані на основі окремих підмоделей.%
\item Функції належності у формі базисних поліномів Бернштейна високих
порядків не створюють достатньо розрізнених нечітких множин. Вони
сильно перекриваються.%
\end{enumerate}

\subsection{Класичний алгоритм Кастельжо}
\label{casteljau_section} Класичний прямий алгоритм Кастельжо
добре відомий як один з методів побудови кривих та поверхонь
Без'є~\cite{Hartmut-Wolfgang, Deniskin}. У випадку побудови кривої
Без'є задається довільна множина базових контрольних точок на
площині $\{\mathbf{a}_j\in{\mathbb R^2}:j=1,\ldots,d\}$. Для
кожної барицентричної координати $u$, використовуючи ітеративну
формулу лінійної інтерполяції двох контрольних точок:
\begin{equation}
\label{linear_interpol_bezier_point_1D}
\begin{array}{l}
\mathbf{a}_j^t(u)=(1-u)\mathbf{a}_j^{t-1}(u)+
u\mathbf{a}_{j+1}^{t-1}(u), \quad \mathbf{a}_j^0\equiv\mathbf{a}_j,\\
t=1,\ldots,d;\qquad j=0,\ldots,d-t;
\end{array}
\end{equation}
знаходиться точка-елемент кривої Без'є $\mathbf{a}_0^d(u)$
(рис.~\ref{fig:bezier_curve_casteljau}).
\begin{figure}[ht]
\safepdf{\centerline{\includegraphics[height=6cm]{CHAPTER2/EPS/bc_casteljau.pdf}}}
{\centerline{\psfig{figure=CHAPTER2/EPS/bc_casteljau.eps,height=6cm}}}
\caption{Побудова кривої Без'є методом Кастельжо.}
\label{fig:bezier_curve_casteljau}
\end{figure}

У випадку побудови поверхні Без'є задається довільна множина
базових контрольних точок $\{\mathbf{r}_{ijk}\in {\mathbb
R^3}:i+j+k=d\}$. Для кожної пари барицентричних координат $u$ і
$v$, використовуючи ітеративну формулу лінійної інтерполяції
кожних трьох контрольних точок:
\begin{equation}
\label{linear_interpol_bezier_point}
\begin{array}{l}
\mathbf{r}_{ijk}^t(\mathbf{u})=u\mathbf{r}_{i+1jk}^{t-1}(\mathbf{u})+
v\mathbf{r}_{ij+1k}^{t-1}(\mathbf{u})+(1-u-v)\mathbf{r}_{ijk+1}^{t-1}(\mathbf{u}),
\quad \mathbf{r}_{ijk}^0\equiv\mathbf{r}_{ijk},\\
t=1,\ldots,d;\qquad i+j+k=d-t;
\end{array}
\end{equation}
знаходиться точка-елемент поверхні Без'є
$\mathbf{r}_{000}^{d}(\mathbf{u})$ (рис.~\ref{fig:casteljau3d}).
\begin{figure}[ht]
\safepdf{\centerline{\includegraphics[height=10cm]{CHAPTER2/EPS/casteljau3d.pdf}}}
{\centerline{\psfig{figure=CHAPTER2/EPS/casteljau3d.eps,height=10cm}}}
\caption{Робота алгоритму Кастельжо для поверхні Без'є.}
\label{fig:casteljau3d}
\end{figure}

\subsection{Обернений алгоритм Кастельжо}
Не порушуючи загальності розглянемо обернений алгоритм Кастельжо для
поверхонь Без'є. Більш простий варіант алгоритму для кривих Без'є
будується аналогічно. Показано, наприклад в~\cite{Deniskin}, що
будь-яка точка на поверхні Без'є може бути представлена у вигляді
лінійної комбінації базисних поліномів Бернштейна:
\begin{equation}
\label{bezier_point}
\mathbf{r}_{000}^{d}(\mathbf{u})=\sum_{i+j+k=d}\mathbf{r}_{ijk}\phi_{ijk}^{d}(\mathbf{u}).
\end{equation}
Цей важливий наслідок слідує з властивості рекурсивного обчислення
базисних поліномів Бернштейна:
$$
\phi_{ijk}^d(\mathbf{u})=u\phi_{i-1jk}^{d-1}(\mathbf{u})+v\phi_{ij-1k}^{d-1}(\mathbf{u})
+(1-u-v)\phi_{ijk-1}^{d-1}(\mathbf{u}).
$$
Обернений алгоритм Кастельжо полягає в
наступному~\cite{Hong-Harris, Harris-Hong-2}. Для
задачі~(\ref{bivar_expan}) вектор
$\mathbf{r}_{000}^{d}(\mathbf{u})$ розглядається як
$$
\mathbf{r}_{000}^{d}=\left(x^p, x^q, B_{pq}(x^p, x^q)\right)^\top .
$$
У цьому випадку рівність~(\ref{bezier_point}) можна переписати у
вигляді наступної системи рівнянь:
$$
\left\{
\begin{array}{l}
(x^p,x^q)^\top =\sum_{i+j+k=d}\mathbf{b}_{ijk}\phi_{ijk}^d(\mathbf{u})\\
B_{pq}(x^p,x^q)=\sum_{i+j+k=d}w_{ijk}\phi_{ijk}^d(\mathbf{u})
\end{array}
\right.,
$$
де $\mathbf{b}_{ijk}$ --- проекція $\mathbf{r}_{ijk}$ на площину
$X_{pq}$. Тоді часткова задача наближення поліному у формі
Бернштейна $B_{pq}(x^p, x^q)$ поверхнею Без'є зводиться до
визначення вагових коефіцієнтів $w_{ijk}$. Для цього необхідно
побудувати відображення підпростору вхідних змінних
$\mathcal{X}_{pq}=\spanv{\mathbf{e}^p, \mathbf{e}^q}$ у простір
барицентричних координат $\mathcal{U}^2$ на основі заданої множини
базових контрольних точок $\Lambda_{pq}=\{\mathbf{b}_{ijk}\in
{\mathbb R^2}:i+j+k=d\}$, $\mathbf{b}_{ijk}\equiv\mathbf{b}_{ijk}^0$
(рис.~\ref{fig:casteljau2d}).
\begin{figure}[ht]
\safepdf{\centerline{\includegraphics[height=9cm]{CHAPTER2/EPS/casteljau2d.pdf}}}
{\centerline{\psfig{figure=CHAPTER2/EPS/casteljau2d.eps,height=9cm}}}
\caption{Обчислення контрольних точок для побудови проекції поверхні
Без'є на площині.} \label{fig:casteljau2d}
\end{figure}
Побудова такого відображення на основі ітераційного чисельного
методу зворотного розповсюдження помилки полягає в наступному:
\begin{enumerate}
\item Задається множина базових контрольних точок $\Lambda_{pq}$,
яка формує опуклу оболонку таку, що містить всі пари $(x^p,x^q)$.%
\item Метод застосовується для кожної пари $(x^p,x^q)$ з вхідного
підпростору. Вибираємо конкретну пару $\mathbf{x}_{pq} = (x^p,x^q)^\top $.%
\item Нехай $m=1$ --- перша ітерація. Вибираємо випадково пару
барицентричних координат $\mathbf{u}^{(m)}\in
\triangle\{u^{(m)}\geqslant0, v^{(m)}\geqslant0, u^{(m)}+v^{(m)}\leqslant1 \}$.%
\item \label{iter_step} Для $\mathbf{u}^{(m)}$ обчислюється
проекція $\hat{\mathbf{x}}_{pq}$ відповідної точки на поверхні
Без'є за допомогою алгоритму Кастельжо, використовуючи аналог
формули~(\ref{linear_interpol_bezier_point}) на площині:
$$
\begin{array}{c}
\mathbf{b}_{ijk}^t\left(\mathbf{u}^{(m)}\right)=u\mathbf{b}_{i+1jk}^{t-1}\left(\mathbf{u}^{(m)}\right)+
v\mathbf{b}_{ij+1k}^{t-1}\left(\mathbf{u}^{(m)}\right)+(1-u-v)\mathbf{b}_{ijk+1}^{t-1}\left(\mathbf{u}^{(m)}\right),\\
t=1,\ldots,d;\qquad i+j+k=d-t;\qquad
\hat{\mathbf{x}}_{pq}\left(\mathbf{u}^{(m)}\right)=
\mathbf{b}_{000}^{d}\left(\mathbf{u}^{(m)}\right).
\end{array}
$$
%\hat{\mathbf{x}}_{pq}\left(\mathbf{u}^{(m)}\right)=
%\mathbf{b}_{000}^{d}\left(\mathbf{u}^{(m)}\right)=
%\sum_{i+j+k=d}\mathbf{b}_{ijk}\phi_{ijk}^{d}\left(\mathbf{u}^{(m)}\right).
Зазначимо, що формула~(\ref{bezier_point}) не використовується,
тому що не дає необхідних, як буде видно далі, проміжних значень
контрольних точок. \item За схемою зворотного розповсюдження
помилки знаходиться нова точка:
$$
\mathbf{x}^{\ast}_{pq}\left(\mathbf{u}^{(m)}\right)=
\hat{\mathbf{x}}_{pq}\left(\mathbf{u}^{(m)}\right)+\alpha\left[
\mathbf{x}_{pq}-
\hat{\mathbf{x}}_{pq}\left(\mathbf{u}^{(m)}\right)\right],
$$
де $\alpha$ --- рівень навчання --- $0<\alpha\ll 1$. %
\item Наступна пара барицентричних координат $\mathbf{u}^{(m+1)}$
обчислюється за допомогою формули:
$$
\begin{array}{l}
\mathbf{u}^{(m+1)}=\left( \mathbf{b}_{100}^{d-1} -
\mathbf{b}_{001}^{d-1}, \mathbf{b}_{010}^{d-1} -
\mathbf{b}_{001}^{d-1}\right)^{-1}\left( \mathbf{x}^{\ast}_{pq} -
\mathbf{b}_{001}^{d-1} \right),
\end{array}
$$
де контрольні точки $\mathbf{b}_{001}^{d-1},
\mathbf{b}_{010}^{d-1}, \mathbf{b}_{100}^{d-1}$ отримані на
кроці~\ref{iter_step}.
 \item Метод продовжується поки не отримаємо пару
барицентричних координат $\mathbf{u}^{(\ast)}$, для якої $\|
\hat{\mathbf{x}}_{pq} - \mathbf{x}_{pq}\| \leqslant \varepsilon$,
де $\varepsilon$ --- задана точність методу. Як це показано
в~\cite{Hong-Harris}, побудований таким чином метод є збіжним.
%
\end{enumerate}
Як буде показано далі, за рахунок спеціального вибору множини
базових контрольних точок, можна вивести аналітичну формулу
обчислення барицентричних координат.
